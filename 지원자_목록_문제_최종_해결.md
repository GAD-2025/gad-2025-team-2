# 지원자 목록이 안 보이는 문제 - 최종 해결 가이드

## 🔍 현재 상황
- 고용주 user_id: `employer-c33d319f`
- 공고 개수: 2개
- 지원자 목록: 0명 (빈 배열 반환)

## 📋 확인해야 할 사항

### 1단계: MySQL Workbench에서 진단 실행

`지원자_목록_실시간_진단.sql` 파일을 실행하세요.

**확인 사항:**
1. **고용주 연결 체인**: `employer_profiles` → `employers` → `jobs` → `applications` 연결이 올바른지
2. **공고 목록**: 이 고용주의 공고가 올바른 `employerId`를 가지고 있는지
3. **지원 내역**: 실제로 `applications` 테이블에 지원 내역이 있는지

### 2단계: 백엔드 로그 확인

백엔드 서버 PowerShell 창에서 다음 로그를 확인하세요:

**채용 페이지 접속 시:**
```
[DEBUG] list_applications - userId로 employerId 찾기 시작: employer-c33d319f
[DEBUG] list_applications - employer profile 조회 결과: ...
[DEBUG] list_applications - employer 조회 결과: ...
[DEBUG] list_applications - employerId 설정 완료: ...
[DEBUG] list_applications - employerId로 공고 필터링 시작: ...
[DEBUG] list_applications - employerId ...의 공고 개수: ...
[DEBUG] list_applications - 공고 IDs: ...
[DEBUG] list_applications - 최종 반환할 결과 개수: ...
```

**오류 메시지 확인:**
- `[ERROR] employer_profile을 찾을 수 없음` → `employer_profiles` 테이블 확인
- `[ERROR] employer를 찾을 수 없음` → `employers` 테이블 확인
- `[WARNING] 이 고용주에게 공고가 없음` → `jobs.employerId` 확인 필요
- `[WARNING] 반환할 결과가 없습니다` → 지원 내역이 없거나 연결 문제

### 3단계: 실제 지원 내역 확인

**가장 중요한 확인:**
1. **구직자가 실제로 지원했는지 확인**
   - 구직자로 로그인하여 지원한 공고 확인
   - 지원 완료 메시지가 나왔는지 확인

2. **applications 테이블에 데이터가 있는지 확인**
   ```sql
   USE team2_db;
   SELECT COUNT(*) as total_applications FROM applications;
   SELECT * FROM applications ORDER BY appliedAt DESC LIMIT 10;
   ```

3. **지원한 공고의 employerId 확인**
   ```sql
   USE team2_db;
   SELECT 
       a.applicationId,
       a.jobId,
       j.title,
       j.employerId,
       e.id as employer_exists
   FROM applications a
   INNER JOIN jobs j ON a.jobId = j.id
   LEFT JOIN employers e ON j.employerId = e.id
   ORDER BY a.appliedAt DESC
   LIMIT 10;
   ```

## 🔧 가능한 문제와 해결 방법

### 문제 1: jobs.employerId가 NULL이거나 잘못된 값

**확인:**
```sql
SELECT j.id, j.title, j.employerId, e.id as employer_exists
FROM jobs j
LEFT JOIN employers e ON j.employerId = e.id
WHERE j.store_id IN (
    SELECT s.id FROM stores s WHERE s.user_id = 'employer-c33d319f'
);
```

**해결:**
```sql
UPDATE jobs j
INNER JOIN stores s ON j.store_id = s.id
INNER JOIN employer_profiles ep ON ep.user_id = s.user_id
INNER JOIN employers e ON e.businessNo = ep.id
SET j.employerId = e.id
WHERE s.user_id = 'employer-c33d319f'
  AND (j.employerId IS NULL OR j.employerId = '' OR j.employerId != e.id);
```

### 문제 2: 지원 내역이 applications 테이블에 저장되지 않음

**확인:**
- 구직자가 지원할 때 백엔드 로그에서 `create_application` 관련 오류 확인
- 브라우저 콘솔에서 지원 API 호출 결과 확인

**해결:**
- 구직자가 다시 지원 시도
- 백엔드 로그에서 오류 메시지 확인

### 문제 3: employerId 연결이 끊어짐

**확인:**
```sql
SELECT 
    ep.user_id,
    ep.id as profile_id,
    e.id as employer_id,
    e.businessNo
FROM employer_profiles ep
LEFT JOIN employers e ON e.businessNo = ep.id
WHERE ep.user_id = 'employer-c33d319f';
```

**해결:**
- `employers` 테이블에 레코드가 없으면 `지원자_목록_문제_수정.sql`의 2번 쿼리 실행

## ✅ 빠른 해결 방법

1. **MySQL Workbench에서 `지원자_목록_실시간_진단.sql` 실행**
2. **결과 확인:**
   - `application_count`가 0이면 → 실제로 지원 내역이 없음
   - `application_count`가 0보다 크면 → API 연결 문제
3. **백엔드 로그 확인** → 오류 메시지 확인
4. **문제에 따라 위의 해결 방법 적용**

## 📝 다음 정보를 제공해주세요

1. MySQL Workbench에서 실행한 `지원자_목록_실시간_진단.sql` 결과
2. 백엔드 서버 로그의 `list_applications` 관련 메시지
3. 구직자가 실제로 지원했는지 여부
4. `applications` 테이블에 데이터가 있는지 여부

