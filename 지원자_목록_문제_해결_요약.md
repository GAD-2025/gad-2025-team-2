# 고용주가 지원자를 볼 수 없는 문제 - 빠른 해결 가이드

## 🎯 문제 요약
구직자가 공고에 지원했는데, 고용주가 채용 페이지에서 지원자를 볼 수 없습니다.

## 🔍 가장 가능성 높은 원인
1. **`jobs.employerId`가 NULL이거나 잘못된 값** (가장 흔함)
2. **`employers` 테이블에 고용주 레코드가 없음**
3. **`employer_profiles`와 `employers` 간의 연결이 끊어짐**

## ✅ 빠른 해결 방법 (3단계)

### 1단계: MySQL Workbench에서 진단 실행
`지원자_목록_문제_진단.sql` 파일을 실행하여 문제를 확인하세요.

### 2단계: MySQL Workbench에서 수정 실행
`지원자_목록_문제_수정.sql` 파일을 실행하여 문제를 수정하세요.

**이 SQL은 다음을 수행합니다:**
- `jobs.employerId`가 NULL인 공고를 `store_id` 기반으로 수정
- `employers` 테이블에 없는 고용주 레코드 자동 생성
- 모든 공고의 `employerId`를 올바르게 재설정

### 3단계: 확인
1. 브라우저에서 고용주로 로그인
2. 채용 페이지로 이동
3. 지원자 목록이 표시되는지 확인

## 📋 수정 SQL 실행 순서

```sql
USE team2_db;

-- 1. jobs.employerId 수정
UPDATE jobs j
INNER JOIN stores s ON j.store_id = s.id
INNER JOIN employer_profiles ep ON ep.user_id = s.user_id
INNER JOIN employers e ON e.businessNo = ep.id
SET j.employerId = e.id
WHERE j.employerId IS NULL OR j.employerId = '';

-- 2. employers 레코드 생성 (없는 경우)
INSERT INTO employers (id, businessNo, shopName, industry, address, openHours, contact, media, minLanguageLevel, needVisa, baseWage, schedule)
SELECT 
    CONCAT('employer-', SUBSTRING(ep.id, 1, 12)) as id,
    ep.id as businessNo,
    COALESCE(ep.company_name, '회사명 없음') as shopName,
    '기타' as industry,
    COALESCE(ep.address, '') as address,
    '09:00-18:00' as openHours,
    COALESCE((SELECT email FROM signup_users WHERE id = ep.user_id), '') as contact,
    '[]' as media,
    'TOPIK 1급' as minLanguageLevel,
    '[]' as needVisa,
    10000 as baseWage,
    '09:00-18:00' as schedule
FROM employer_profiles ep
WHERE NOT EXISTS (
    SELECT 1 FROM employers e WHERE e.businessNo = ep.id
);
```

## 🔧 문제가 계속되면

1. **백엔드 서버 재시작**
   ```powershell
   cd gad-2025-team-2\backend
   .\venv\Scripts\python.exe -m uvicorn app.main:app --reload
   ```

2. **브라우저 하드 리프레시**
   - `Ctrl + Shift + R` (Windows)
   - 또는 개발자 도구(F12) → Network 탭 → "Disable cache" 체크

3. **새 공고 등록 후 지원 테스트**
   - 고용주로 로그인 → 새 공고 등록
   - 구직자로 로그인 → 해당 공고에 지원
   - 고용주로 다시 로그인 → 채용 페이지 확인

## 📝 확인 체크리스트

- [ ] `지원자_목록_문제_진단.sql` 실행 완료
- [ ] `지원자_목록_문제_수정.sql` 실행 완료
- [ ] 백엔드 서버 재시작 완료
- [ ] 브라우저 하드 리프레시 완료
- [ ] 고용주로 로그인하여 채용 페이지 확인
- [ ] 지원자 목록이 표시되는지 확인

## 🆘 여전히 안 되면

다음 정보를 제공해주세요:
1. MySQL Workbench에서 실행한 진단 SQL 결과
2. 백엔드 서버 로그 (특히 `list_applications` 관련)
3. 브라우저 콘솔의 오류 메시지
4. 고용주 user_id (localStorage에서 `signup_user_id` 확인)
