# 구직자 로그인 문제 해결 가이드

## 문제 상황

새로 회원가입한 구직자 계정으로 로그인이 안 됨

## 가능한 원인

### 1. 전화번호 형식 불일치
- **회원가입 시**: 하이픈 포함 (`010-1234-5678`)
- **로그인 시**: 하이픈 미포함 (`01012345678`)
- **해결**: 백엔드에서 하이픈을 자동으로 제거하지만, 데이터베이스에 저장된 형식 확인 필요

### 2. 비밀번호 해시 문제
- 회원가입 시 비밀번호가 제대로 해시되지 않음
- 데이터베이스에 비밀번호가 NULL이거나 빈 문자열

### 3. 계정이 실제로 생성되지 않음
- 회원가입 API 호출은 성공했지만 데이터베이스에 저장되지 않음

## 진단 방법

### 1. MySQL Workbench에서 확인

`구직자_로그인_문제_진단.sql` 파일 실행:

```sql
USE team2_db;

-- 최근 가입한 구직자 계정 확인
SELECT 
    id,
    role,
    name,
    phone,
    password IS NOT NULL as has_password,
    LENGTH(password) as password_length,
    created_at
FROM signup_users
WHERE role = 'job_seeker'
ORDER BY created_at DESC
LIMIT 10;
```

### 2. 백엔드 로그 확인

백엔드 서버 PowerShell 창에서 다음 메시지 확인:

**로그인 시도 시:**
```
[LOGIN] 로그인 시도: role=job_seeker, identifier=01012345678
[SUCCESS] 사용자 발견: id=..., name=..., role=job_seeker
[DEBUG] 입력 비밀번호 해시: ...
[DEBUG] 저장된 비밀번호 해시: ...
```

**오류 메시지:**
- `[ERROR] 사용자를 찾을 수 없음` → 전화번호 불일치
- `[ERROR] 비밀번호가 설정되지 않음` → 비밀번호가 NULL
- `[ERROR] 비밀번호 불일치` → 비밀번호 해시 불일치

### 3. 브라우저 개발자 도구 확인

1. F12 → Network 탭 열기
2. 로그인 버튼 클릭
3. `/auth/signin/new` 요청 확인
4. Request Payload 확인:
   ```json
   {
     "identifier": "01012345678",
     "password": "your_password",
     "role": "job_seeker"
   }
   ```
5. Response 확인:
   - 401: 인증 실패 (계정 없음 또는 비밀번호 불일치)
   - 500: 서버 오류

## 해결 방법

### 방법 1: 전화번호 형식 통일

**회원가입 시 입력한 전화번호를 그대로 사용:**
- `010-1234-5678`로 가입했다면 → `010-1234-5678`로 로그인
- `01012345678`로 가입했다면 → `01012345678`로 로그인

**또는 하이픈 없이 입력:**
- 백엔드에서 자동으로 하이픈을 제거하므로 하이픈 없이 입력해도 됨

### 방법 2: 비밀번호 재설정

MySQL Workbench에서:

```sql
USE team2_db;

-- 특정 계정의 비밀번호 업데이트
UPDATE signup_users
SET password = 'ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f'  -- password123 해시
WHERE phone = '가입한_전화번호'  -- 예: '01012345678'
  AND role = 'job_seeker';
```

### 방법 3: 계정 확인 및 재생성

1. **계정이 있는지 확인:**
   ```sql
   SELECT * FROM signup_users 
   WHERE phone = '가입한_전화번호' 
     AND role = 'job_seeker';
   ```

2. **없으면 회원가입 다시 시도**

3. **있으면 비밀번호 확인:**
   ```sql
   SELECT 
       id,
       phone,
       password IS NOT NULL as has_password,
       LENGTH(password) as password_length
   FROM signup_users
   WHERE phone = '가입한_전화번호'
     AND role = 'job_seeker';
   ```

## 체크리스트

- [ ] MySQL Workbench에서 계정이 생성되었는지 확인
- [ ] 전화번호 형식 확인 (하이픈 포함/미포함)
- [ ] 비밀번호가 NULL이 아닌지 확인
- [ ] 백엔드 로그에서 오류 메시지 확인
- [ ] 브라우저 Network 탭에서 API 요청/응답 확인

## 테스트 계정 사용

임시로 테스트 계정 사용:
- 전화번호: `01012345678`
- 비밀번호: `password123`

`구직자_테스트_계정_생성.sql` 실행하여 생성 가능

